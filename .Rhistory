add_text_id <- function(
tbl,
text_id="text_id"
){
cnames <- colnames(tbl)
tbl %>%
#     dplyr::mutate(tmp = dplyr::case_when((.["表層形"]=="EOS" & is.na(.["品詞"])) ~ 1, TRUE~ 0)) %>%
dplyr::mutate(tmp = dplyr::case_when(
(dplyr::select(., 1)=="EOS" & is.na(dplyr::select(., 2))) ~ 1, TRUE ~ 0)
) %>%
dplyr::mutate(tmp = purrr::accumulate(tmp, magrittr::add)) %>%
dplyr::mutate(tmp = tmp + 1) %>%
magrittr::set_colnames(c(cnames, text_id))
}
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir="D:/pf/MeCab/bin", fileEncoding="CP932") %>%
print(n=nrow(.))
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
print()
readLines("output.txt",  encoding="CP932") %>%
tibble::tibble(tmp=.) %>%
tidyr::separate(tmp, sep="\t|,", into=letters[1:10], fill="right", extra="drop") %>%
magrittr::set_colnames(out_cols)
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble(tmp=.) %>%
tidyr::separate(tmp, sep="\t|,", into=letters[1:10], fill="right", extra="drop") %>%
magrittr::set_colnames(out_cols)
out_cols <- c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音")
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble(tmp=.) %>%
tidyr::separate(tmp, sep="\t|,", into=letters[1:10], fill="right", extra="drop") %>%
magrittr::set_colnames(out_cols)
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble(tmp=.)
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
~tibble::tibble(tmp=.)
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble(., tmp=.)
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble()
readLines("d:/pf/mecab/bin/output.txt",  encoding="CP932") %>%
tibble::tibble() %>%
magrittr::set_colnames("tmp")
q()
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="UTF-8")
neko <- "吾輩は猫である。名前はまだ無い。"
neko
usethis::use_data(neko_utf8)
iconv(neko, from="utf-8", to="cp932")
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="cp932")
neko <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_sjis)
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="UTF-8")
neko_utf8 <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_utf8)
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="cp932")
neko_sjis <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_sjis)
library(moranajp)
library(tidyverse)
library(moranajp)
neko
data(neko)
"neko"
neko
neko_utf8
data(neko_utf8)
neko_utf8
data(neko_sjis)
neko_sjis
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="UTF-8")
neko_utf8 <- "吾輩は猫である。名前はまだ無い。"
neko_sjis <- iconv(neko_utf8, from="utf-8", to="cp932")
usethis::use_data(neko_utf8)
usethis::use_data(neko_sjis)
q()
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="UTF-8")
neko_utf8 <- "吾輩は猫である。名前はまだ無い。"
neko_sjis <- iconv(neko_utf8, from="utf-8", to="cp932")
usethis::use_data(neko_utf8)
usethis::use_data(neko_sjis)
usethis::use_data(neko_utf8, overwrite = TRUE)
usethis::use_data(neko_sjis, overwrite = TRUE)
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
library(moranajp)
data("neko_sjis")
data("neko_utf8")
neko_sjis
neko_uft8
data(neko_utf8)
neko_uft8
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
neko_uft8
neko_sjis
library(moranajp)
dat(neko)
data(neko)
neko
data(neko_utf8)
data(neko_sjis)
neko_sjis
neko_utf8
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="UTF-8")
neko_utf8 <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_utf8, overwrite = TRUE)
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="cp832")
neko_sjis <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_sjis, overwrite = TRUE)
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
neko_sjis
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="cp932")
neko_sjis <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_sjis, overwrite = TRUE)
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
neko_sjis
neko_utf8
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
neko_utf8
iconv(neko_sjis, from="cp932", to="utf-8")
iconv(neko_utf8, from="utf-8, to=""cp932")
iconv(neko_utf8, from="utf-8", to="cp932")
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
data(neko_sjis)
data(neko_utf8)
neko_sjis
neko_utf8
iconv(neko_utf8, from="utf-8", to="cp932")
iconv(neko_sjis, from="cp932", to="utf-8")
options(encoding="cp932")
iconv(neko_utf8, from="utf-8", to="cp932")
iconv(neko_sjis, from="cp932", to="utf-8")
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding)
options()
str(options())
options(encoding="UTF-8")
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
data(neko_utf8)
neko_sjis
neko_utf8
iconv(neko_utf8, from="utf-8", to="cp932")
rm(list=ls(all=TRUE)); gc(); gc()
options(encoding="cp932")
neko_sjis <- "吾輩は猫である。名前はまだ無い。"
usethis::use_data(neko_sjis, overwrite = TRUE)
load("D:/matu/work/ToDo/moranajp/data/neko_sjis.rda")
neko_sjis
load("D:/matu/work/ToDo/moranajp/data/neko_utf8.rda")
neko_utf8
library(moranajp)
data(neko_sjis)
data(neko_utf8)
neko_sjis
neko_utf8
iconv(neko_utf8, from="utf-8", to="cp932")
iconv(neko_sjis, from="cp932", to="utf-8")
iconv(neko_sjis, from="utf-8", to="cp932")
iconv(neko_utf8, from="cp932", to="utf-8")
rm(list=ls(all=TRUE)); gc(); gc()
neko_utf8 <- "吾輩は猫である。名前はまだ無い。"
neko_utf8
neko_utf8 <- iconv(neko_utf8, from="cp932", to="utf-8")
neko_utf8
usethis::use_data(neko_utf8, overwrite = TRUE)
library(moranajp)
data(neko_sjis)
data(neko_utf8)
neko_sjis
neko_utf8
iconv(neko_utf8, from="utf-8", to="cp932")
?shell
?shell
system
?system
shell
library(moranajp)
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
# neko$text <- iconv(neko$text, from="cp932", to="utf-8")# Mac, LinuxなどUTF-8の場合
neko
# Directory of mecab
# No need when setting path to mecab
# MeCabの実行ファイルのディレクトリ
# pathがとおっている場合は，設定不要
bin_dir <- "c:/MeCab/bin"  # set your environment
# Fileencoding in mecab. "CP932" (shift_jis) , "UTF-8" or "EUC"
# MeCab.exeの文字コード
fileEncoding <- "CP932"  # set your environment
bin_dir <- "d:/pf/MeCab/bin"  # set your environment
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding)
mecab
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
# neko$text <- iconv(neko$text, from="cp932", to="utf-8")# Mac, LinuxなどUTF-8の場合
neko
# Directory of mecab
# No need when setting path to mecab
# MeCabの実行ファイルのディレクトリ
# pathがとおっている場合は，設定不要
bin_dir <- "c:/MeCab/bin"  # set your environment
# Fileencoding in mecab. "CP932" (shift_jis) , "UTF-8" or "EUC"
# MeCab.exeの文字コード
fileEncoding <- "CP932"  # set your environment
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
bin_dir <- "d:/fp/MeCab/bin"
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
bin_dir <- "d:/pg/MeCab/bin"
bin_dir <- "d:/pf/MeCab/bin"
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
tmp_dir < -NULL
str_c(NULL, "a")
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
neko
# Directory of mecab
# No need when setting path to mecab
# MeCabの実行ファイルのディレクトリ
# pathがとおっている場合は，設定不要
bin_dir <- "c:/MeCab/bin/"  # set your environment
# Fileencoding in mecab. "CP932" (shift_jis) , "UTF-8" or "EUC"
# MeCabの文字コード
fileEncoding <- "CP932"  # set your environment
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
bin_dir <- "d:/fp/MeCab/bin/"  # se
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
bin_dir <- "d:/pf/MeCab/bin/"  # se
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
mecab
tmp_dir <- null
tmp_dir <- NULL
NULL
tmp_dir
bin_dir
if(tmp_dir) tmp_dir <- bin_dir
if(tmp_dir)
1 else2
is.null(tmp_dir)
if(is.null(tmp_dir)) tmp_dir <- bin_dir
tmp_dir
library(moranajp)
library(tidyverse)
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
neko
# Directory of mecab
# No need when setting path to mecab
# MeCabの実行ファイルのディレクトリ
# pathがとおっている場合は，設定不要
bin_dir <- "c:/MeCab/bin/"  # set your environment
# Fileencoding in mecab. "CP932" (shift_jis) , "UTF-8" or "EUC"
# MeCabの文字コード
fileEncoding <- "CP932"  # set your environment
bin_dir <- "d:/pf/MeCab/bin/"
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
mecab()
mecab
out_cols
out_col
res
colnames(res[1:10]) <- 1:10
res
colnames(res[1:10])
colnames(res[1:10]) <- letters[1:10]
res
c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音", colnames(11:ncol(res)))
colnames(11:ncol(res))
res
colnames(res)[11:ncol(res)]
c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音", colnames(res)[11:ncol(res)])
colnames(res) <- c(letters[1:10], colnames(res)[11:ncol(res)])
res
colnames(res) <- c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音", colnames(res)[11:ncol(res)])
res
out_cols
out_cols <- c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音",
)
out_cols <- c("表層形", "品詞", "品詞細分類1", "品詞細分類2", "品詞細分類3", "活用型", "活用形", "原形", "読み", "発音")
out_cols
stringi::stri_escape_unicode(out_cols)
cat(stringi::stri_escape_unicode(out_cols))
out_cols <- c("\u8868\u5c64\u5f62", "\u54c1\u8a5e", "\u54c1\u8a5e\u7d30\u5206\u985e1",
"\u54c1\u8a5e\u7d30\u5206\u985e2", "\u54c1\u8a5e\u7d30\u5206\u985e3", "\u6d3b\u7528\u578b",
"\u6d3b\u7528\u5f62", "\u539f\u5f62", "\u8aad\u307f", "\u767a\u97f3")
out_cols
library(moranajp)
data(neko)
neko
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
neko
bin_dir <- "d:/pf/MeCab/bin/"  #
fileEncoding <- "CP932"  # set your environment
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
library(moranajp)
library(moranajp)
library(tidyverse)
library(magrittr)
data(neko)
neko
# Directory of mecab
# No need when setting path to mecab
# MeCabの実行ファイルのディレクトリ
# pathがとおっている場合は，設定不要
bin_dir <- "c:/MeCab/bin/"  # set your environment
# Fileencoding in mecab. "CP932" (shift_jis) , "UTF-8" or "EUC"
# MeCabの文字コード
fileEncoding <- "CP932"  # set your environment
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
bin_dir <- "d:/pf/MeCab/bin/"  # s
res <-
neko %>%
mutate(cols=rep(1:2, each=2)) %>%
mecab_all(text_col="text", bin_dir=bin_dir, fileEncoding=fileEncoding) %>%
print(n=nrow(.))
library(moranajp)
neko
data(neko)
neko
neko
neko$text
neko[[1]]
neko[1]
neko[1,]
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
neko
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
stringr::str_detect
neko
str_c(neko$text)
stringr::str_c(neko$text)
?stringr::str_c(neko$text)
stringr::str_c(neko$text, collapse=FALSE)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
tbl <- neko
tbl
tbl <- tbl %>% dplyr::mutate(text_id=1:nrow(tbl))
tbl
if(stringr::str_detect(stringr::str_c(tbl$text_col, collaspe=FALSE), "\\r\\n")) warning("removed line breaks !")
if(stringr::str_detect(stringr::str_c(tbl$text_col, collaspe=FALSE), "\\n")) warning("removed line breaks !")
stringr::str_c(tbl$text_col, collaspe=FALSE)
tbl <- neko
text_col = "text"
tmp_dir = "d:/pf/mecab/bin"
fileEncoding = "CP932
""
fileEncoding = "CP932"
fileEncoding = "CP932"
tbl <- tbl %>% dplyr::mutate(text_id=1:nrow(tbl))
others <- dplyr::select(tbl, !dplyr::all_of(text_col))
if(stringr::str_detect(stringr::str_c(tbl$text_col, collaspe=FALSE), "\\r\\n")) warning("removed line breaks !")
if(stringr::str_detect(stringr::str_c(tbl$text_col, collaspe=FALSE), "\\n")) warning("removed line breaks !")
tbl$text_col
text_col
tbl
tbl$"text"
tbl[[text_col]]
if(stringr::str_detect(stringr::str_c(tbl[[text_col]], collaspe=FALSE), "\\r\\n")) warning("removed line breaks !")
if(stringr::str_detect(stringr::str_c(tbl[[text_col]], collaspe=FALSE), "\\n"))    warning("removed line breaks !")
stringr::str_c(tbl[[text_col]], collaspe=FALSE)
if(stringr::str_detect(stringr::str_c(tbl[[text_col]], collapse=FALSE), "\\r\\n")) warning("removed line breaks !")
if(stringr::str_detect(stringr::str_c(tbl[[text_col]], collapse=FALSE), "\\n"))    warning("removed line breaks !")
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
neko[1,]
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
a
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
?note
caution
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
library(moranajp)
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
neko
neko %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(!!text_col, "\\r\\n", "")) %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(!!text_col, "\\n", ""))
text_col
neko %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(text_col, "\\r\\n", "")) %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(text_col, "\\n", ""))
neko %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(all_of(text_col), "\\r\\n", "")) %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(all_of(text_col), "\\n", ""))
neko %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(.data[[text_col]], "\\r\\n", "")) %>%
dplyr::mutate(!!text_col := stringr::str_replace_all(.data[[text_col]], "\\n", ""))
library(moranajp)
neko[1,] <- "吾輩は猫である。\n名前はまだ無い。"
bin_dir <- "d:/pf/mecab/bin/"
fileEncoding <- "CP932"
mecab_all(neko, bin_dir=bin_dir, fileEncoding=fileEncoding)
